<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOSTEL HUB</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Top navigation bar -->
    <nav class="navbar-top">
        <span class="navbar-heading">JL HOSTELS</span>
        <ul>
            <li><a href="login.html">Login</a></li>
            <li><a href="register.html">Register</a></li>
        </ul>
    </nav>

    <!-- Modern hero section -->
    <header class="hero-header">
        <div class="hero-bg"></div>
        <div class="hero-content container">
            <p class="hero-sub">Find, Book, and Enjoy the Best Hostels in Ghana</p>
        </div>
    </header>

    <!-- Booking Steps Section -->
    <section class="booking-steps container modern-card">
        <h2 class="booking-title">Book a room with these simple steps</h2>
        <div class="steps-flex">
            <div class="step-card">
                <img src="images/Copilot_20250712_111146.png" alt="Find available rooms" class="step-img">
                <span class="step-label">Find available rooms</span>
            </div>
            <div class="step-card">
                <img src="images/albert-vincent-wu-5LNoiVdL9SI-unsplash.jpg" alt="Book a bed" class="step-img">
                <span class="step-label">Book a bed</span>
            </div>
            <div class="step-card">
                <img src="images/Copilot_20250712_121555.png" alt="Pay instantly or later" class="step-img">
                <span class="step-label">Pay instantly or later!</span>
            </div>
        </div>
        <div class="booking-btn-wrap">
            <a href="register.html" class="booking-btn">Book now!</a>
        </div>
    </section>

    <!-- Hostel Listing Section -->
    <section class="container" id="hostel-listings">
        <h2>Available Hostels</h2>
        <div class="hostel-grid" id="hostel-grid">
            <!-- Hostels will be loaded dynamically -->
        </div>
    </section>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-copy">
            &copy; 2025 JL HOSTELS. All rights reserved.
        </div>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            // Check if user is logged in
            const token = localStorage.getItem('token');
            if (token) {
                // Change "Register" to "Dashboard" if logged in
                const registerLink = document.querySelector('.navbar-top a[href="register.html"]');
                if (registerLink) {
                    const role = localStorage.getItem('role');
                    registerLink.textContent = role === 'admin' ? 'Admin Dashboard' : 'My Dashboard';
                    registerLink.href = role === 'admin' ? 'dashboard/admin.html' : 'dashboard/tenant.html';
                }
            }

            // Load featured hostels
            try {
                const response = await fetch('/api/hostels?limit=3');
                const hostels = await response.json();
                
                const hostelGrid = document.getElementById('hostel-grid');
                if (hostels.length > 0 && hostelGrid) {
                    hostelGrid.innerHTML = hostels.map(hostel => `
                        <div class="card" data-name="${hostel.name}" data-location="${hostel.campus}">
                            <img src="images/${hostel.name.toLowerCase().replace(/\s+/g, '-')}.webp" alt="${hostel.name}">
                            <h3>${hostel.name}</h3>
                            <p>${hostel.campus} Campus</p>
                            <p>Available Rooms: ${hostel.roomTypes.reduce((sum, room) => sum + room.available, 0)}</p>
                            <a href="register.html?campus=${hostel.campus}" class="action-btn">Book Now</a>
                        </div>
                    `).join('');
                } else if (hostelGrid) {
                    hostelGrid.innerHTML = '<p>No hostels available at the moment. Please check back later.</p>';
                }
            } catch (error) {
                console.error('Error loading hostels:', error);
                const hostelGrid = document.getElementById('hostel-grid');
                if (hostelGrid) {
                    hostelGrid.innerHTML = '<p>Unable to load hostels. Please try again later.</p>';
                }
            }

            // Campus selection from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const campusParam = urlParams.get('campus');
            if (campusParam && document.getElementById('campus-input')) {
                document.getElementById('campus-input').value = campusParam;
            }
        });
    </script>
</body>
</html>